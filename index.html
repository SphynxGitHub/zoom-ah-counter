<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Toastmasters Ah-Counter ğŸ™ï¸</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css" />

  <!-- Zoom JS -->
  <script src="https://source.zoom.us/zoomapps/1.1.0/lib.js"></script>
</head>
<body>

  <!-- âœ… Launch button for Zoom Client -->
  <button id="openInZoom" class="open-zoom-btn">
    ğŸš€ Open in Zoom
  </button>

  <div class="wrap">
    <h1>Toastmasters Ah-Counter ğŸ™ï¸</h1>

    <div id="usageHeader" class="subheader">
      ğŸ’¡ <strong>How to Use:</strong> Left-click adds +1, right-click subtracts âˆ’1. 
      Click <span class="remove-sample">Ã—</span> to remove a speaker or filler word.
    </div>

    <div id="participantContainer" class="grid">
      <div class="loading">Add participants to begin</div>
    </div>

    <div class="controls">
      <button id="addSpeaker">+ Add Speaker</button>
      <button id="showSummary">Show Summary</button>
      <button id="resetAll">Reset All</button>
    </div>

    <div class="footer">
      ğŸ”Š Make sure your computer sound is on
    </div>
  </div>

  <!-- Summary modal -->
  <div id="summaryModal" class="modal hidden">
    <div class="modal-content">
      <h2>Summary of Counts</h2>
      <div id="summaryList"></div>
      <div class="modal-buttons">
        <button id="copySummary">Copy</button>
        <button id="closeSummary">Close</button>
      </div>
    </div>
  </div>

  <!-- Add Filler Modal -->
  <div id="addFillerModal" class="modal hidden">
    <div class="modal-content">
      <h2>Add a new filler word</h2>
      <input id="newFillerInput" type="text" placeholder="Type filler word...">
      <div class="modal-buttons">
        <button id="saveFiller">Add</button>
        <button id="cancelFiller">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Add Speaker Modal -->
  <div id="addSpeakerModal" class="modal hidden">
    <div class="modal-content">
      <h2>Add a new speaker</h2>
      <input id="newSpeakerInput" type="text" placeholder="Type speaker name...">
      <div class="modal-buttons">
        <button id="saveSpeaker">Add</button>
        <button id="cancelSpeaker">Cancel</button>
      </div>
    </div>
  </div>

  <!-- Confirm Remove Modal -->
  <div id="confirmModal" class="modal hidden">
    <div class="modal-content">
      <h2>Remove filler?</h2>
      <div id="confirmText"></div>
      <div class="modal-buttons">
        <button id="confirmYes">Remove</button>
        <button id="confirmNo">Cancel</button>
      </div>
    </div>
  </div>

 <script src="app.js"></script>

  <!-- âœ… Zoom Launch Deep Link -->
  <script>
    const deepLink = "https://marketplace.zoom.us/zoomapp/TSGu3pxJTCyhUy0VtGbqlA/context/panel/target/launch/deeplink";

    document.getElementById("openInZoom").addEventListener("click", () => {
      
      if (window.navigator.userAgent.includes("ZoomApps")) {
        zoomSdk.openUrl({
          url: deepLink,
          context: "inClient"
        }).catch(err => console.error("Zoom SDK open failed:", err));
        return;
      }

      window.location.href = deepLink;

      setTimeout(() => {
        if (!document.getElementById("zoomFailMessage")) {
          const msg = document.createElement("p");
          msg.id = "zoomFailMessage";
          msg.innerHTML = `
            If Zoom did not open automatically,
            <a href="zoommtg://zoom.us" style="color:#0E71EB;font-weight:600">
              click here to open Zoom
            </a>.
          `;
          document.body.appendChild(msg);
        }
      }, 3000);
    });

    // Hide button when already running inside Zoom
    if (window.navigator.userAgent.includes("ZoomApps")) {
      document.getElementById("openInZoom").style.display = "none";
    }
  </script>

</body>
</html>
